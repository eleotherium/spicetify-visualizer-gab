/* ==== Fundo lava-lamp ==== */
.lavaBg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0; /* fundo */
  overflow: hidden;
  background: radial-gradient(circle at 30% 30%, #341a6e, transparent 60%),
              radial-gradient(circle at 70% 70%, #182a91, transparent 60%),
              radial-gradient(circle at 40% 80%, #60139f, transparent 70%);
  background-blend-mode: screen;
  animation: lavaShift 16s ease-in-out infinite alternate;
  filter: blur(50px) brightness(1.1) saturate(1.2);
  transform-origin: center;
}

@keyframes lavaShift {
  0% { transform: scale(1) translate(0, 0); }
  50% { transform: scale(1.05) translate(-2%, 1%); }
  100% { transform: scale(1.03) translate(2%, -1%); }
}

/* ==== Letras overlay ==== */
.lyricsOverlayBox {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 2;
  color: rgba(255, 255, 255, 0.85);
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.6);
  font-size: clamp(16px, 2.2vw, 28px);
  line-height: 1.4;
}

.overlayLine {
  opacity: 0.5;
}

.overlayCurr {
  font-weight: 700;
  opacity: 1;
}

/* ==== Letras triplet (Rest Mode) ==== */
.lyricsTriplet {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-bottom: 20px;
  text-align: center;
}

.linePrev,
.lineNext {
  color: rgba(255, 255, 255, 0.65);
  font-size: clamp(16px, 1.6vw, 22px);
}

.lineCurr {
  font-weight: 800;
  font-size: clamp(22px, 2vw, 32px);
}

/* ==== Rest Mode layout ==== */
.restRoot {
  position: relative;
  width: 100%;
  height: 100vh;
  overflow: hidden;
}

.restGrid {
  position: relative;
  z-index: 1;
  display: grid;
  grid-template-columns: minmax(300px, 38%) 1fr;
  gap: 32px;
  padding: 40px;
  align-items: center;
}

.restLeft {
  display: flex;
  align-items: center;
  justify-content: center;
}

.spectrumCanvas {
  position: fixed; /* sai do fluxo e cola no topo da janela */
  inset: 0; /* cobre tudo */
  width: 100vw;
  height: 100vh;
  z-index: 9999; /* acima de tudo, inclusive menus */
  pointer-events: none;
  background: #000 !important; /* base sólida */
  mix-blend-mode: normal !important; /* sem blend com lava lamp */
  isolation: isolate; /* cria stacking context próprio */
  opacity: 1 !important;
  will-change: transform;
  contain: paint; /* otimiza composição */
}

.lyricsOverlayBox,
.lyricsTriplet {
  position: relative;
  z-index: 2;
}

.visualizer-container {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: #000; /* fallback preto */
}

.coverArt {
  width: 100%;
  max-width: 520px;
  aspect-ratio: 1/1;
  border-radius: 20px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.45);
}

.restRight {
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.restViz {
  margin-top: 20px;
  height: 28vh;
  min-height: 180px;
  border-radius: 16px;
  overflow: hidden;
  background: rgba(0, 0, 0, 0.25);
}
